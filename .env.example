# JWT Secrets (generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))")
JWT_SECRET=your_secret_here
JWT_REFRESH_SECRET=your_secret_here

# Encryption
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
ENCRYPTION_KEY=your_key_here
ENCRYPTION_ALGORITHM=aes-256-gcm

# Database
MONGODB_URI=your_mongodb_uri

# Server
PORT=5000
NODE_ENV=production

# Security
ADMIN_IP_WHITELIST=your.ip.here

# Frontend URLs
CLIENT_URL=https://traf3li.com
DASHBOARD_URL=https://dashboard.traf3li.com

# Stripe
STRIPE_SECRET_KEY=your_stripe_key

# Cloudinary
CLOUDINARY_CLOUD_NAME=your_name
CLOUDINARY_API_KEY=your_key
CLOUDINARY_API_SECRET=your_secret

# AWS S3 (for file storage)
AWS_ACCESS_KEY_ID=your_access_key_id
AWS_SECRET_ACCESS_KEY=your_secret_access_key
AWS_REGION=me-south-1

# S3 Buckets - Use either naming convention:
# Option 1 (recommended): S3_BUCKET_* prefix
S3_BUCKET_DOCUMENTS=traf3li-legal-documents
S3_BUCKET_JUDGMENTS=traf3li-case-judgments
S3_BUCKET_TASKS=traf3li-task-attachments

# Option 2 (alternative): AWS_S3_* prefix
# AWS_S3_BUCKET=traf3li-legal-documents
# AWS_S3_BUCKET_DOCUMENTS=traf3li-legal-documents
# AWS_S3_JUDGMENTS_BUCKET=traf3li-case-judgments

# S3 Logging Buckets (optional - for access tracking)
# Enable versioning on main buckets for version history support
S3_BUCKET_DOCUMENTS_LOGS=traf3li-documents-logs
S3_BUCKET_TASKS_LOGS=traf3li-tasks-logs
# Alternative naming:
# AWS_S3_BUCKET_DOCUMENTS_LOGS=traf3li-documents-logs
# AWS_S3_BUCKET_TASKS_LOGS=traf3li-tasks-logs

# S3 Server-Side Encryption (SSE)
# SSE is enabled by default using AES256 (SSE-S3)
S3_SSE_ENABLED=true
S3_SSE_ALGORITHM=AES256
# For SSE-KMS encryption with Bucket Key (reduces KMS costs):
# S3_SSE_ALGORITHM=aws:kms
# S3_KMS_KEY_ID=arn:aws:kms:region:account:key/key-id
# S3_BUCKET_KEY_ENABLED=true

# Presigned URL expiry time in seconds (default: 3600 = 1 hour)
PRESIGNED_URL_EXPIRY=3600

# ==========================================
# REDIS CONFIGURATION
# ==========================================

# Redis connection URL
# Format: redis://[username]:[password]@[host]:[port]/[database]
# Examples:
#   Local: redis://localhost:6379
#   Docker: redis://redis:6379
#   Cloud: redis://:password@redis.example.com:6379
REDIS_URL=redis://localhost:6379

# Redis password (leave empty for local development without auth)
REDIS_PASSWORD=

# ⚠️  REDIS OPTIMIZATION FOR FREE TIER (Upstash 500k requests/month)
# Set these to reduce Redis usage if you're hitting limits:

# Disable Bull job queues entirely (email, PDF, reports run synchronously)
# Set to "true" to save ~70k requests/month from queue polling
DISABLE_QUEUES=false

# Disable Redis caching, use in-memory cache instead
# Set to "true" to eliminate cache-related Redis calls
# Note: In-memory cache is per-process, not shared across instances
DISABLE_REDIS_CACHE=false

# Redis use cases in this application:
# - Idempotency keys for preventing duplicate transactions
# - Response caching for high-traffic endpoints (dashboard, clients, cases)
# - Session storage
# - Rate limiting counters
# - Job queues (email, PDF, reports, cleanup, sync, notifications)

# ==========================================
# ACCOUNTING SYSTEM CONFIGURATION
# ==========================================

# Currency Settings
DEFAULT_CURRENCY=SAR

# Default Account IDs (set after running seed:accounts)
# These are populated by the seeder, but can be overridden
# ACCOUNTS_RECEIVABLE_ID=
# ACCOUNTS_PAYABLE_ID=
# SERVICE_REVENUE_ID=
# BANK_ACCOUNT_MAIN_ID=

# Accounting Features
ENABLE_ACCOUNTING=true
REQUIRE_IDEMPOTENCY_KEYS=true

# External Integrations (optional)
# Twilio for SMS notifications
# TWILIO_ACCOUNT_SID=
# TWILIO_AUTH_TOKEN=
# TWILIO_PHONE_NUMBER=

# ==========================================
# LOGGING CONFIGURATION
# ==========================================

# Log level: error, warn, info, debug
LOG_LEVEL=info

# ==========================================
# ANALYTICS CONFIGURATION
# ==========================================

# Analytics event tracking (matches frontend taxonomy)
# Events tracked: page_view, search, form_submit, error, api_call, user_action
# Set to false to disable analytics tracking
ENABLE_ANALYTICS=true

# Analytics buffer settings
# Events are batched and flushed periodically to reduce overhead
ANALYTICS_BUFFER_FLUSH_INTERVAL=30000
ANALYTICS_MAX_BUFFER_SIZE=100

# External analytics integrations (optional)
# Google Analytics Measurement Protocol
# GA_MEASUREMENT_ID=G-XXXXXXXXXX
# GA_API_SECRET=your_api_secret

# Mixpanel
# MIXPANEL_TOKEN=your_mixpanel_token

# Segment
# SEGMENT_WRITE_KEY=your_segment_write_key

# ==========================================
# PERFORMANCE MONITORING
# ==========================================

# API response time target (in ms)
# Frontend expects backend APIs to respond within this threshold
API_RESPONSE_TIME_TARGET=300

# Performance thresholds (in ms)
# PERF_THRESHOLD_EXCELLENT=100
# PERF_THRESHOLD_GOOD=300
# PERF_THRESHOLD_ACCEPTABLE=1000
# PERF_THRESHOLD_SLOW=3000

# Performance monitoring endpoints
# GET /metrics/performance - Detailed API performance metrics
# Includes: avg response time, percentiles (p50, p90, p99), slowest endpoints

# ==========================================
# SENTRY ERROR TRACKING
# ==========================================

# Sentry DSN (Data Source Name) - Get this from your Sentry project settings
SENTRY_DSN=https://your-sentry-dsn@sentry.io/your-project-id

# Sentry environment (production, staging, development)
SENTRY_ENVIRONMENT=production

# Sentry traces sample rate (0.0 to 1.0, where 1.0 = 100%)
# Lower values reduce performance monitoring overhead
SENTRY_TRACES_SAMPLE_RATE=0.1

# Sentry profiles sample rate (0.0 to 1.0, where 1.0 = 100%)
# Only needed if using profiling
SENTRY_PROFILES_SAMPLE_RATE=0.1

# ==========================================
# WHATSAPP / META CONFIGURATION
# ==========================================

# Meta WhatsApp Business API
# WHATSAPP_PHONE_NUMBER_ID=
# WHATSAPP_ACCESS_TOKEN=
# WHATSAPP_VERIFY_TOKEN=
# WHATSAPP_BUSINESS_ACCOUNT_ID=

# ==========================================
# EMAIL CONFIGURATION
# ==========================================

# Resend API for email sending
RESEND_API_KEY=your_resend_api_key

# Email sender configuration
EMAIL_FROM=noreply@traf3li.com
EMAIL_FROM_NAME=Traf3li
EMAIL_REPLY_TO=support@traf3li.com

# Email branding
LOGO_URL=https://traf3li.com/logo.png

# Email templates support both Arabic and English
# Templates include: welcome, otp, invoice, payment-receipt, case-update, reminder, password-reset
# Layouts: base (full featured), notification (simple), transactional (invoices/receipts)

# ==========================================
# SAUDI BANKING INTEGRATION
# ==========================================

# Lean Technologies (Open Banking)
# LEAN_APP_TOKEN=
# LEAN_CUSTOMER_ID=

# SADAD Integration
# SADAD_MERCHANT_ID=
# SADAD_API_KEY=

# ZATCA (VAT Invoicing)
# ZATCA_API_KEY=
# ZATCA_ORGANIZATION_ID=

# ==========================================
# BACKUP CONFIGURATION
# ==========================================

# S3 Backup Bucket
BACKUP_S3_BUCKET=traf3li-backups

# Retention Policies (in days/weeks/months)
BACKUP_RETENTION_DAYS=7
BACKUP_RETENTION_WEEKS=4
BACKUP_RETENTION_MONTHS=12
BACKUP_RETENTION_YEARS=3

# Backup Schedules (cron expressions)
# Daily at 2 AM
BACKUP_SCHEDULE_DAILY=0 2 * * *
# Weekly on Sunday at 3 AM
BACKUP_SCHEDULE_WEEKLY=0 3 * * 0
# Monthly on the 1st at 4 AM
BACKUP_SCHEDULE_MONTHLY=0 4 1 * *
# Redis every 6 hours
BACKUP_SCHEDULE_REDIS=0 */6 * * *

# Notification Settings
BACKUP_NOTIFICATION_ENABLED=true
BACKUP_NOTIFICATION_EMAIL=admin@traf3li.com
BACKUP_NOTIFY_ON_SUCCESS=false

# Backup Settings
BACKUP_TEMP_DIR=/tmp/backups
BACKUP_MAX_FILE_SIZE=524288000
BACKUP_COMPRESSION_LEVEL=6

# Point-in-Time Recovery (PITR)
BACKUP_ENABLE_PITR=false
BACKUP_PITR_INTERVAL=15

# Redis Settings (if different from main Redis)
REDIS_DATA_DIR=/data

# Restore Settings
RESTORE_TEMP_DIR=/tmp/restore
RESTORE_BACKUP_BEFORE=true
